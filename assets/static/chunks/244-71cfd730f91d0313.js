"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[244],{6427:(e,t,s)=>{s.d(t,{A:()=>m});var a=s(5155),l=s(2115),r=s(1154),n=s(1007),o=s(1264),c=s(5525),i=s(4355),d=s(3453),x=s(4239);let m=()=>{let[e,t]=(0,l.useState)(null),[s,m]=(0,l.useState)({total:0,present:0,absent:0,percentage:0}),[u,h]=(0,l.useState)(!0);if((0,l.useEffect)(()=>{(async()=>{try{let e=await (0,x.VU)();t(e);let s=e.role||e.userType||"Student";if(e&&(e._id||e.id)&&"student"===s.toLowerCase()){let t=e._id||e.id;await (0,x.Yq)(t,e=>{let t=e.data||[],s=e.totalRecords||t.length,a=t.filter(e=>{var t;return(null==(t=e.status)?void 0:t.toLowerCase())==="present"}).length,l=s>0?(a/s*100).toFixed(1):0;m({total:s,present:a,absent:s-a,percentage:l})},e=>console.error("Failed to load attendance",e))}}catch(e){console.error("Profile load error",e)}finally{h(!1)}})()},[]),u)return(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)(r.A,{className:"h-8 w-8 animate-spin text-indigo-600"})});if(!e)return(0,a.jsx)("div",{className:"text-center text-slate-500",children:"No user data found."});let g=()=>e.role||e.userType||"Student",p="student"===g().toLowerCase(),f="teacher"===g().toLowerCase();return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[f&&(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800 mb-4 px-1",children:"Teacher Dashboard Overview"}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[(0,a.jsx)("div",{className:"h-32 bg-gradient-to-r from-indigo-600 to-purple-600"}),(0,a.jsxs)("div",{className:"px-6 pb-6",children:[(0,a.jsxs)("div",{className:"relative flex items-end -mt-12 mb-6",children:[(0,a.jsx)("div",{className:"p-1 bg-white rounded-full",children:(0,a.jsx)("div",{className:"h-24 w-24 bg-slate-100 rounded-full flex items-center justify-center border-4 border-indigo-50",children:(0,a.jsx)(n.A,{className:"h-12 w-12 text-slate-400"})})}),(0,a.jsxs)("div",{className:"ml-4 mb-1",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:e.name||e.firstName+" "+(e.lastName||"")||"N/A"}),(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 mt-1 capitalize",children:g()})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wider",children:"Personal Information"}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-slate-50 border border-slate-100",children:[(0,a.jsx)("div",{className:"p-2 bg-indigo-100 rounded-lg",children:(0,a.jsx)(o.A,{className:"h-4 w-4 text-indigo-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Email Address"}),(0,a.jsx)("p",{className:"text-sm font-medium text-slate-700",children:e.email||"N/A"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wider",children:"Account Details"}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-slate-50 border border-slate-100",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)(c.A,{className:"h-4 w-4 text-purple-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"User Role"}),(0,a.jsx)("p",{className:"text-sm font-medium text-slate-700 capitalize",children:g()})]})]})]})]})]})]}),p&&(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,a.jsx)(i.A,{className:"h-5 w-5 text-indigo-600"}),(0,a.jsx)("h3",{className:"text-lg font-bold text-slate-800",children:"Attendance Analytics"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100 flex flex-col items-center justify-center",children:[(0,a.jsx)("span",{className:"text-slate-500 text-sm font-medium mb-1",children:"Total Classes"}),(0,a.jsx)("span",{className:"text-2xl font-bold text-slate-800",children:s.total})]}),(0,a.jsxs)("div",{className:"p-4 bg-green-50 rounded-xl border border-green-100 flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 text-green-600"}),(0,a.jsx)("span",{className:"text-green-700 text-sm font-medium",children:"Present"})]}),(0,a.jsx)("span",{className:"text-2xl font-bold text-green-800",children:s.present})]}),(0,a.jsxs)("div",{className:"p-4 bg-indigo-50 rounded-xl border border-indigo-100 flex flex-col items-center justify-center relative overflow-hidden",children:[(0,a.jsx)("span",{className:"text-indigo-700 text-sm font-medium mb-1",children:"Attendance Rate"}),(0,a.jsxs)("span",{className:"text-3xl font-bold text-indigo-800",children:[s.percentage,"%"]}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 h-1 bg-indigo-200 w-full",children:(0,a.jsx)("div",{className:"h-full bg-indigo-600 transition-all duration-1000",style:{width:"".concat(s.percentage,"%")}})})]})]})]})]})}},7634:(e,t,s)=>{s.d(t,{A:()=>d});var a=s(5155),l=s(2115),r=s(5799),n=s(8222),o=s(2105),c=s(8020);let i=e=>{let{classroomId:t,onClose:s,socket:n,messages:o=[],currentUser:c}=e,[i,d]=(0,l.useState)(""),[x,m]=(0,l.useState)(!1),u=(0,l.useRef)(null),h=(0,l.useRef)(null),g=(0,l.useRef)(0),p=(0,l.useCallback)(()=>{var e;null==(e=u.current)||e.scrollIntoView({behavior:"smooth"})},[]);(0,l.useEffect)(()=>{o.length>g.current&&setTimeout(p,100),g.current=o.length},[o,p]),(0,l.useEffect)(()=>{var e;null==(e=h.current)||e.focus(),setTimeout(p,100)},[p]);let f=(0,l.useCallback)(async()=>{let e=i.trim();if(e){if(!n)return void r.oR.error("Connection lost. Please refresh.");m(!0);try{var s;n.sendMessage(t,e),d(""),null==(s=h.current)||s.focus()}catch(e){console.error("Failed to send message:",e),r.oR.error("Failed to send message")}finally{m(!1)}}},[i,n,t]),b=(0,l.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),f())},[f]),j=(0,l.useCallback)(()=>{(!i.trim()||window.confirm("You have unsent text. Close anyway?"))&&s()},[i,s]);(0,l.useEffect)(()=>{let e=e=>{"Escape"===e.key&&j()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[j]);let w=e=>e?new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center p-4 transition-opacity duration-300",onClick:j,children:(0,a.jsxs)("div",{className:"bg-white w-full max-w-lg rounded-2xl shadow-2xl flex flex-col h-[85vh] max-h-[700px] overflow-hidden border border-gray-100",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center px-6 py-4 bg-white border-b border-gray-100 shadow-sm z-10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-bold",children:"#"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:"Class Discussion"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 font-medium",children:[o.length," messages"]})]})]})]}),(0,a.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors",onClick:j,children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50/50 custom-scrollbar",children:0===o.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 opacity-60",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-3",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,a.jsx)("p",{className:"text-sm font-medium",children:"No messages yet. Be the first!"})]}):(0,a.jsxs)(a.Fragment,{children:[o.map((e,t)=>{let s=c&&e.nickname===c.nickname,l=t===o.length-1,r=0===t||o[t-1].nickname!==e.nickname;return(0,a.jsx)("div",{className:"flex w-full ".concat(s?"justify-end":"justify-start"," animate-in fade-in slide-in-from-bottom-2 duration-300"),children:(0,a.jsxs)("div",{className:"flex max-w-[75%] ".concat(s?"flex-row-reverse":"flex-row"," gap-2"),children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex flex-col justify-end",children:r?(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold border-2 border-white shadow-sm ".concat(s?"bg-indigo-600 text-white":"bg-gray-200 text-gray-600"),children:(e=>e?e.split(" ").map(e=>e[0]).slice(0,2).join("").toUpperCase():"?")(e.nickname)}):(0,a.jsx)("div",{className:"w-8"})}),(0,a.jsxs)("div",{className:"flex flex-col ".concat(s?"items-end":"items-start"),children:[r&&!s&&(0,a.jsx)("span",{className:"text-[11px] text-gray-500 font-semibold ml-1 mb-1",children:e.nickname}),(0,a.jsxs)("div",{className:"px-4 py-2.5 shadow-sm text-sm relative group ".concat(s?"bg-indigo-600 text-white rounded-2xl rounded-tr-none":"bg-white text-gray-800 border border-gray-100 rounded-2xl rounded-tl-none"),children:[(0,a.jsx)("p",{className:"whitespace-pre-wrap leading-relaxed",children:e.message}),(0,a.jsx)("div",{className:"absolute bottom-0 ".concat(s?"-left-12":"-right-12"," opacity-0 group-hover:opacity-100 transition-opacity text-[10px] text-gray-400 py-3"),children:w(e.createdAt||e.timestamp)})]}),l&&(0,a.jsxs)("span",{className:"text-[10px] text-gray-300 mt-1 px-1",children:[s?"Sent":"Received"," â€¢ ",w(e.createdAt||e.timestamp)]})]})]})},"".concat(e.timestamp||t,"-").concat(e.message))}),(0,a.jsx)("div",{ref:u})]})}),(0,a.jsxs)("div",{className:"p-4 bg-white border-t border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-end gap-2 bg-gray-50 p-2 rounded-xl border border-gray-200 focus-within:border-indigo-400 focus-within:ring-2 focus-within:ring-indigo-100 transition-all",children:[(0,a.jsx)("textarea",{ref:h,className:"flex-1 bg-transparent border-none focus:ring-0 text-gray-700 placeholder-gray-400 resize-none py-2 px-2 max-h-32 text-sm",placeholder:"Type your message...",value:i,onChange:e=>d(e.target.value),onKeyDown:b,rows:1,style:{minHeight:"44px"},disabled:x}),(0,a.jsx)("button",{className:"p-2 rounded-lg mb-1 transition-all duration-200 ".concat(i.trim()?"bg-indigo-600 text-white hover:bg-indigo-700 shadow-md":"bg-gray-200 text-gray-400 cursor-not-allowed"),onClick:f,disabled:x||!i.trim(),children:x?(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5 transform rotate-[-45deg] translate-x-0.5 -translate-y-0.5",children:(0,a.jsx)("path",{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"})})})]}),(0,a.jsxs)("p",{className:"text-[10px] text-center text-gray-400 mt-2",children:["Press ",(0,a.jsx)("span",{className:"font-mono bg-gray-100 px-1 rounded",children:"Enter"})," to send"]})]})]})})},d=()=>{let e=(0,n.F)(),[t,s]=(0,l.useState)([]),[d,x]=(0,l.useState)(!0),[m,u]=(0,l.useState)(null),[h,g]=(0,l.useState)(null),[p,f]=(0,l.useState)({}),[b,j]=(0,l.useState)(""),w=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await (0,o.VU)();if(!e)return;u(t);let a=[];if(t.role,a=await (0,o.pn)(null),!e)return;let l=(null==a?void 0:a.length)?a:(null==a?void 0:a.classrooms)||[];s(l)}catch(e){console.error("Init Error:",e),r.oR.error("Failed to load classrooms")}finally{e&&x(!1)}})(),()=>{e=!1}},[]);let v=(0,l.useCallback)(e=>{let t=e.classroom_id||e.classroomId||e._id;s(s=>s.map(s=>String(s._id)===String(t)?{...s,discussion:[...s.discussion||[],{nickname:e.nickname||"User",message:e.message,createdAt:e.createdAt||new Date().toISOString(),timestamp:Date.now()}]}:s))},[]),N=(0,l.useCallback)((e,t)=>{"started"===e?r.oR.info("Attendance Started for: ".concat(t.classroom_name)):"punchIn"===e?t.success?r.oR.success("Punch In Successful!"):r.oR.error(t.message):"punchOut"===e&&(t.success?r.oR.success("Punch Out Successful!"):r.oR.error(t.message))},[]);(0,l.useEffect)(()=>{if(e&&t.length>0){var s,a;let l=e.socket||e;l&&!1===l.connected&&(l.connect?l.connect():l.open&&l.open()),null==(s=e.removeCallback)||s.call(e,"newMessageCallback"),null==(a=e.removeCallback)||a.call(e,"attendanceStartedCallback"),e.setCallback("newMessageCallback",v),e.setCallback("attendanceStartedCallback",e=>N("started",e)),e.setCallback("punchInCallback",e=>N("punchIn",e)),e.setCallback("punchOutCallback",e=>N("punchOut",e));let r=t.map(e=>e._id);"function"==typeof e.joinClassRoom?e.joinClassRoom(r):e.socket&&e.socket.emit("join_classroom",r)}},[e,t,v,N]),(0,l.useEffect)(()=>{if(0!==Object.keys(p).length)return w.current=setInterval(()=>{let t=Date.now();f(s=>{let a={...s},l=!1;return Object.entries(s).forEach(s=>{let[n,o]=s;t>=o&&((null==e?void 0:e.stopAttendance)&&e.stopAttendance(n),delete a[n],l=!0,r.oR.info("Attendance ended automatically."))}),l?a:s})},1e3),()=>clearInterval(w.current)},[p,e]);let y=(t,s)=>e?navigator.geolocation?void navigator.geolocation.getCurrentPosition(a=>{let l={classroom_id:s,location:{lat:a.coords.latitude,long:a.coords.longitude}};"punchIn"===t&&e.punchIn?e.punchIn(l):"punchOut"===t&&e.punchOut?e.punchOut(l):e.socket.emit("punchIn"===t?"punch_in":"punch_out",l)},e=>{console.error(e),r.oR.error("Location access denied.")}):r.oR.error("Geolocation not supported"):r.oR.error("Socket not connected");if(d||!m)return(0,a.jsx)(c.A,{});let k=t.filter(e=>e.name.toLowerCase().includes(b.toLowerCase()));return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50/50 px-4 sm:px-6 py-10",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto mb-10 flex flex-col md:flex-row items-center justify-between gap-6",children:[(0,a.jsxs)("div",{className:"text-center md:text-left",children:[(0,a.jsx)("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"My Classrooms"}),(0,a.jsx)("p",{className:"text-gray-500 mt-1",children:"Manage your sessions and connect with your class."})]}),(0,a.jsxs)("div",{className:"relative w-full md:w-96",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search for a classroom...",value:b,onChange:e=>j(e.target.value),className:"w-full pl-11 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 shadow-sm transition-all"}),(0,a.jsx)("span",{className:"absolute left-3.5 top-3.5 text-gray-400",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})]}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[0===k.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 bg-white rounded-2xl border border-dashed border-gray-300",children:[(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-full mb-4",children:(0,a.jsx)("svg",{className:"w-10 h-10 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),(0,a.jsx)("p",{className:"text-lg font-medium text-gray-900",children:"No classrooms found"}),(0,a.jsx)("p",{className:"text-gray-500 mt-1",children:b?"We couldn't find matches for \"".concat(b,'"'):"You haven't been assigned to any classrooms yet."})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:k.map(t=>{var s;let l=p[t._id],n=!!l,o=n?Math.max(0,Math.ceil((l-Date.now())/1e3)):0;return(0,a.jsxs)("div",{className:"group bg-white rounded-2xl shadow-sm hover:shadow-xl border border-gray-100 overflow-hidden transition-all duration-300 flex flex-col",children:[(0,a.jsx)("div",{className:"h-20 w-full relative ".concat(n?"bg-gradient-to-r from-green-500 to-emerald-600":"bg-gradient-to-r from-blue-500 to-indigo-600"),children:n&&(0,a.jsxs)("div",{className:"absolute top-3 right-3 bg-white/20 backdrop-blur-md px-3 py-1 rounded-full flex items-center gap-2 border border-white/30",children:[(0,a.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,a.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-white opacity-75"}),(0,a.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-white"})]}),(0,a.jsx)("span",{className:"text-xs font-bold text-white tracking-wide",children:"LIVE ATTENDANCE"})]})}),(0,a.jsxs)("div",{className:"p-6 pt-0 flex-1 flex flex-col relative",children:[(0,a.jsx)("div",{className:"absolute -top-10 left-6 h-16 w-16 bg-white p-1 rounded-2xl shadow-md",children:(0,a.jsx)("div",{className:"h-full w-full rounded-xl flex items-center justify-center text-2xl font-bold text-white ".concat(n?"bg-green-500":"bg-blue-500"),children:t.name.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{className:"mt-8 mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 truncate",title:t.name,children:t.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[m.role," View"]})]}),(0,a.jsxs)("div",{className:"mt-auto space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>g(t._id),className:"w-full py-2.5 px-4 bg-gray-50 hover:bg-gray-100 text-gray-700 font-medium rounded-lg transition-colors flex items-center justify-center gap-2 border border-gray-200",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),"Discussion ",(0,a.jsx)("span",{className:"bg-gray-200 text-gray-600 text-xs py-0.5 px-2 rounded-full ml-1",children:(null==(s=t.discussion)?void 0:s.length)||0})]}),"Teacher"===m.role&&(0,a.jsx)("button",{onClick:()=>((t,s)=>{if(!e)return r.oR.error("Socket not connected");e.startAttendance?e.startAttendance(t,s,10):e.socket.emit("start_attendance",{classroomId:t,classroom_name:s,duration:10}),f(e=>({...e,[t]:Date.now()+6e5})),r.oR.success("Attendance started (10m)")})(t._id,t.name),disabled:n,className:"w-full py-3 rounded-lg font-semibold transition-all shadow-sm flex items-center justify-center gap-2 ".concat(n?"bg-green-50 text-green-700 border border-green-200 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white hover:shadow-md"),children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsxs)("span",{children:["Ends in ",Math.floor(o/60),"m ",o%60,"s"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("span",{children:"Start 10m Attendance"})]})}),"Student"===m.role&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("button",{onClick:()=>y("punchIn",t._id),className:"py-2.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors shadow-sm hover:shadow flex flex-col items-center justify-center",children:[(0,a.jsx)("span",{className:"text-xs opacity-90 uppercase tracking-wide",children:"Entry"}),(0,a.jsx)("span",{className:"leading-none",children:"Punch In"})]}),(0,a.jsxs)("button",{onClick:()=>y("punchOut",t._id),className:"py-2.5 bg-white border border-red-200 text-red-600 hover:bg-red-50 rounded-lg font-medium transition-colors shadow-sm hover:shadow flex flex-col items-center justify-center",children:[(0,a.jsx)("span",{className:"text-xs opacity-70 uppercase tracking-wide",children:"Exit"}),(0,a.jsx)("span",{className:"leading-none",children:"Punch Out"})]})]})]})]})]},t._id)})}),h&&(0,a.jsx)(i,{classroomId:h,socket:e,onClose:()=>g(null),messages:(()=>{var e;return h&&(null==(e=t.find(e=>String(e._id)===String(h)))?void 0:e.discussion)||[]})(),currentUser:m})]})]})}},8222:(e,t,s)=>{s.d(t,{F:()=>i,SocketProvider:()=>c});var a=s(5155),l=s(2115),r=s(2105),n=s(5799);let o=(0,l.createContext)(null),c=e=>{let{children:t}=e,s=(0,l.useRef)(null),c=(0,l.useRef)({newMessageCallback:()=>{},connectionCallback:()=>{},successCallback:()=>{},errorCallback:()=>{},attendanceStartedCallback:()=>{},attendanceStoppedCallback:()=>{},punchInCallback:()=>{},punchOutCallback:()=>{}});return s.current||(s.current=new r.s_({newMessageCallback:e=>{n.oR.info(e.message),c.current.newMessageCallback(e)},connectionCallback:e=>{n.oR.info(e.message),c.current.connectionCallback(e)},successCallback:e=>{n.oR.info(e.message),c.current.successCallback(e)},errorCallback:e=>{n.oR.error(e.message),c.current.errorCallback(e)},attendanceStartedCallback:e=>{n.oR.info(e.message),c.current.attendanceStartedCallback(e)},attendanceStoppedCallback:e=>{n.oR.info(e.message),c.current.attendanceStoppedCallback(e)},punchInCallback:e=>{n.oR.info(e.message),c.current.punchInCallback(e)},punchOutCallback:e=>{n.oR.info(e.message),c.current.punchOutCallback(e)}}),s.current.setCallback=(e,t)=>{c.current[e]&&(c.current[e]=t)}),(0,a.jsx)(o.Provider,{value:s.current,children:t})},i=()=>(0,l.useContext)(o)}}]);