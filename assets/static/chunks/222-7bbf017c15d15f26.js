"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[222],{2105:(e,t,n)=>{n.d(t,{A$:()=>p,AS:()=>a,DY:()=>c,In:()=>f,Pq:()=>_,QM:()=>h,VU:()=>k,Yq:()=>C,bB:()=>I,eg:()=>S,iD:()=>O,kQ:()=>d,lh:()=>i,lo:()=>r,pn:()=>g,qM:()=>u,s_:()=>w,tq:()=>l,xF:()=>b,xw:()=>E,zz:()=>s});var o=n(4298);let a="https://beginity-test.ddns.net",r=async function(e){let{name:t="",nickname:n="",user_id:o="",email:r="",role:l="",limit:c=10,page:s=1,all:i=!1}=e,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{console.log(e)},d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>console.error(e);try{let e=[];if(t&&e.push("name=".concat(encodeURIComponent(t))),n&&e.push("nickname=".concat(encodeURIComponent(n))),o&&e.push("user_id=".concat(encodeURIComponent(o))),r&&e.push("email=".concat(encodeURIComponent(r))),l&&e.push("role=".concat(encodeURIComponent(l))),s&&e.push("page=".concat(s)),c&&!1===i&&e.push("limit=".concat(encodeURIComponent(c))),i){e.push("limit=".concat(encodeURIComponent(1)));let t=e.length>0?"?".concat(e.join("&")):"",n=await b("".concat(a,"/api/users").concat(t),"GET",{}),o=Number.parseInt(n.totalUsers);if(o<=1)return u(n),n;e.pop(),e.push("limit=".concat(encodeURIComponent(o+1)))}let d=e.length>0?"?".concat(e.join("&")):"";console.log("queryString :",d);let g=await b("".concat(a,"/api/users").concat(d),"GET",{});return u(g),g}catch(e){return d(e),null}},l=async function(e){var t,n;let{name:o="",nickname:a="",user_id:l="",email:c="",role:s=""}=e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{console.log(e)},u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>console.error(e);return(null==(n=await r({name:o,nickname:a,user_id:l,email:c,role:s,limit:1},i,u))||null==(t=n.data)?void 0:t.at(0))||null};async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{console.log(e)},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>console.error(e);e.preventDefault();try{let n=await f("".concat(a,"/api/auth/register"),"POST",m(e.target,e.submitter));t(n)}catch(e){n(e)}}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{console.log(e)},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>console.error(e);e.preventDefault();try{let n=await f("".concat(a,"/api/auth/login"),"POST",m(e.target,e.submitter));t(n),y("token",n.token,1296e6),y("user-login-detail",{...n.user},1296e6)}catch(e){n(e)}}async function i(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{console.log(e)},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>console.error(e);e.preventDefault();let r=new FormData(e.target,e.submitter),l={mandatory:"on"===r.get("mandatory"),image:r.get("image"),title:r.get("title"),description:{detail:r.get("detail"),objectives:r.get("objectives").split("\n"),learning_outcomes:r.get("learning_outcomes").split("\n")},start_time:new Date(r.get("start_time")).toISOString(),end_time:new Date(r.get("end_time")).toISOString(),location:{address:r.get("address"),lat:Number.parseFloat(r.get("lat"))||null,long:Number.parseFloat(r.get("long"))||null},speaker_ids:null==r||null==(t=r.get("speaker_ids"))?void 0:t.split(",").map(e=>e.trim())};console.group("createEvent"),console.log(JSON.stringify(l,null,2));try{let e=await b("".concat(a,"/api/events"),"POST",l);n(e)}catch(e){o(e)}finally{console.groupEnd()}}async function u(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{console.log(e)},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>console.error(e);e.preventDefault();let r=new FormData(e.target,e.submitter),l=r.get("event_id"),c={mandatory:"on"===r.get("mandatory"),image:r.get("image"),title:r.get("title"),description:{detail:r.get("detail"),objectives:r.get("objectives").split("\n"),learning_outcomes:r.get("learning_outcomes").split("\n")},start_time:new Date(r.get("start_time")).toISOString(),end_time:new Date(r.get("end_time")).toISOString(),location:{address:r.get("address"),lat:Number.parseFloat(r.get("lat"))||null,long:Number.parseFloat(r.get("long"))||null},speaker_ids:null==r||null==(t=r.get("speaker_ids"))?void 0:t.split(",").map(e=>e.trim())};console.group("createEvent"),console.log(JSON.stringify(c,null,2));try{let e=await b("".concat(a,"/api/events/").concat(l),"PUT",c);n(e)}catch(e){o(e)}finally{console.groupEnd()}}async function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null==e||e.preventDefault();try{let e=await f("".concat(a,"/api/events/"),"GET",{});return console.log(e),e}catch(e){throw console.error(e),Error(e.message)}}async function g(e){e&&e.preventDefault();try{let e=await b("".concat(a,"/api/classrooms/"),"GET");return console.log(e),e}catch(e){throw Error(e.message)}}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{console.log(e)},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>console.error(e);e.preventDefault();let o=new FormData(e.target,e.submitter);try{let e=v("token");if(!e)throw Error("Log in/ Register to Perform This action");let n=await fetch(a+"/file/upload/",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:o});if(!n.ok){let e=await n.json();throw Error(null==e?void 0:e.message)}let r=await n.json();return t(r),r}catch(e){return n(e),null}}async function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>{console.log(e)},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>console.error(e);try{let o=await f("".concat(a,"/api/auth/otp"),"post",{email:e,purpose:t});return n(o),o}catch(e){return o(e),null}}function m(e,t){let n=new FormData(e,t),o={};for(let[e,t]of n.entries())o[e]=t;return o}async function f(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let o={method:t,headers:{"Content-type":"application/json",Accept:"application/json"},body:JSON.stringify(n)};["GET","HEAD"].includes(t.toUpperCase())&&(o.body=void 0);let a=await fetch(e,o);if(!a.ok){let e=await a.json();throw console.dir(e),Error((null==e?void 0:e.message)||"Unknown Error!")}return await a.json()}catch(e){throw console.dir("Fetch request failed",e),e}}async function b(e,t,n){try{let o=v("token");if(!o)throw Error("Log in/ Register to Perform This action");let a={method:t,headers:{Authorization:"Bearer ".concat(o),"Content-type":"application/json",Accept:"application/json"},body:JSON.stringify(n)};["GET","HEAD"].includes(t.toUpperCase())&&(a.body=void 0);let r=await fetch(e,a);if(!r.ok){let e=await r.json();throw console.dir(e),Error((null==e?void 0:e.message)||"Unknown Error!")}return await r.json()}catch(e){throw console.log(e),e}}function y(e,t,n){let o={value:t,expiry:new Date().getTime()+n};localStorage.setItem(e,JSON.stringify(o))}function v(e){try{let t=localStorage.getItem(e);if(!t)return null;let n=JSON.parse(t);if(new Date().getTime()>n.expiry)return localStorage.removeItem(e),null;return n.value}catch(e){return console.warn("error",e),null}}c.handler=(e,t)=>n=>{c(n,e,t)},s.handler=(e,t)=>n=>{s(n,e,t)},i.handler=(e,t)=>n=>{i(n,e,t)},u.handler=(e,t)=>n=>{u(n,e,t)},h.handler=(e,t)=>n=>{h(n,e,t)};class w{constructor({newMessageCallback:e,connectionCallback:t,successCallback:n,errorCallback:r,attendanceStartedCallback:l,punchInCallback:c,punchOutCallback:s}){if(w.instance)return w.instance;console.log("once created will not again");let i=(0,o.io)(a,{auth:{token:v("token")}});return i.on("punch_in",e=>{console.log(" [socket] punch-in data:",e),console.debug(e),c(e)}),i.on("punch_out",e=>{console.log("[socket] punch-out data:",e),console.debug(e),s(e)}),i.on("new_message",t=>{console.log("[socket] new-message data:",t),console.debug(t),e(t)}),i.on("connection",e=>{console.log(" [socket] connected.."),console.debug(" [socket] connected.."),t(e)}),i.on("success",e=>{(!e||(null==e?void 0:e.message))&&(e.message="connection successful"),console.log("[socket] success message :",e),console.debug(e),n(e)}),i.on("error",e=>{console.log("[socket] error message :",e),console.debug(e),r(e)}),i.on("attendance_started",e=>{console.log("[socket] attendance started data : ",e),console.debug(e),l(e)}),w.instance={socket:i,sendMessage:(e,t)=>{i.emit("new_message",{classroom_id:e,message:t})},startAttendance:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;i.emit("start_attendance",{classroom_id:e,classroom_name:t,timeout:n})},joinClassRoom:e=>{i.emit("join_classroom",{classroom_ids:e})},punchIn:e=>{console.dir(" [socket] punch-in data:",e),i.emit("punch_in",e)},punchOut:e=>{console.dir("[socket] punch-out data:",e),i.emit("punch_out",e)}},w.instance}}let k=async()=>{try{let e=!1;if((e=v("user-login-detail"))&&0!==Object.getOwnPropertyNames(e||{}).length)return e;return!1}catch(e){return console.error((null==e?void 0:e.message)||"unknown error"),!1}};async function C(e,t,n){let{event_id:o,classroom_id:r,user_id:l}=e;try{let e=await b("".concat(a,'/api/attendances?user_id="674b3c5e7fffda283acb6bbf&limit=1"'),"GET",{}),n=null==e?void 0:e.totalRecords;if(console.log("pre :",e),!n)throw Error("No records found!");let o=await b("".concat(a,'/api/attendances?user_id="674b3c5e7fffda283acb6bbf&limit=').concat(n),"GET",{});t(o),console.log(o)}catch(e){n(e),console.log(e)}}async function S(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};try{localStorage.removeItem("token"),localStorage.removeItem("user-login-detail"),e(),console.log("User logged out successfully.")}catch(e){console.error("Logout failed:",e),t(e)}}async function _(){try{var e;return(null==(e=await r({role:"Speaker",all:!0}))?void 0:e.data)||[]}catch(e){return console.error("Error fetching speakers:",(null==e?void 0:e.message)||e),[]}}async function E(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e=>{};try{let r=await f("".concat(a,"/api/auth/password-reset"),"POST",{email:e,otp:t,newPassword:n});return o(r),r}catch(e){return r(e),null}}async function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>{};try{let n=await b("".concat(a,"/api/auth/teacher/").concat(e,"/verify"),"POST");return t(n),n}catch(e){return n(e),null}}async function I(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{};try{let t=await b("".concat(a,"/api/auth/teacher/verification/pending"),"POST");return console.log(t),e(t.data),t.data}catch(e){return t(e),null}}async function R(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{console.log(e)},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>console.error(e);try{let n=(await b("".concat(a,"/api/attendances/report"),"POST",{event_id:e})).data;if(!n)throw Error("No report data received");let o={statusChart:{labels:n.byStatus.map(e=>e._id),data:n.byStatus.map(e=>e.count)},genderChart:{labels:n.byGender.map(e=>e._id),data:n.byGender.map(e=>e.count)},yearChart:{labels:n.byYear.map(e=>e._id),data:n.byYear.map(e=>e.count)},streamChart:{labels:n.byStreamBranch.map(e=>"".concat(e._id.stream," (").concat(e._id.branch,")")),data:n.byStreamBranch.map(e=>e.count)},userMap:n.userMap,rawLists:{byStatus:n.byStatus,byGender:n.byGender,byYear:n.byYear}};return t(o),o}catch(e){return n(e),null}}C({},e=>console.log(e.message),e=>console.error(e.message)),S.handler=(e,t)=>()=>{S(e,t)},R.handler=(e,t)=>n=>{R(n,e,t)}},8222:(e,t,n)=>{n.d(t,{F:()=>i,SocketProvider:()=>s});var o=n(5155),a=n(2115),r=n(2105),l=n(5799);let c=(0,a.createContext)(null),s=e=>{let{children:t}=e,n=(0,a.useRef)(null),s=(0,a.useRef)({newMessageCallback:()=>{},connectionCallback:()=>{},successCallback:()=>{},errorCallback:()=>{},attendanceStartedCallback:()=>{},attendanceStoppedCallback:()=>{},punchInCallback:()=>{},punchOutCallback:()=>{}});return n.current||(n.current=new r.s_({newMessageCallback:e=>{l.oR.info(e.message),s.current.newMessageCallback(e)},connectionCallback:e=>{l.oR.info(e.message),s.current.connectionCallback(e)},successCallback:e=>{l.oR.info(e.message),s.current.successCallback(e)},errorCallback:e=>{l.oR.error(e.message),s.current.errorCallback(e)},attendanceStartedCallback:e=>{l.oR.info(e.message),s.current.attendanceStartedCallback(e)},attendanceStoppedCallback:e=>{l.oR.info(e.message),s.current.attendanceStoppedCallback(e)},punchInCallback:e=>{l.oR.info(e.message),s.current.punchInCallback(e)},punchOutCallback:e=>{l.oR.info(e.message),s.current.punchOutCallback(e)}}),n.current.setCallback=(e,t)=>{s.current[e]&&(s.current[e]=t)}),(0,o.jsx)(c.Provider,{value:n.current,children:t})},i=()=>(0,a.useContext)(c)}}]);